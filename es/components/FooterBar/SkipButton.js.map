{"version":3,"sources":["components/FooterBar/SkipButton.js"],"names":["React","PropTypes","translate","compose","pure","Popover","Tooltip","IconButton","CircularProgress","SkipIcon","SkipReasonsList","popoverPosition","marginThreshold","anchorOrigin","horizontal","vertical","transformOrigin","reasons","SkipButton","state","isSkipping","isOpen","anchor","handleOpen","event","props","userIsDJ","handleSkip","setState","currentTarget","handleClose","reason","Promise","resolve","onSkip","then","render","t","message","user","currentDJ","username","paper","map","name","label","Component","propTypes","func","isRequired","bool","object"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { translate } from 'react-i18next';\nimport compose from 'recompose/compose';\nimport pure from 'recompose/pure';\nimport Popover from '@material-ui/core/Popover';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport IconButton from '@material-ui/core/IconButton';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport SkipIcon from '@material-ui/icons/SkipNext';\nimport SkipReasonsList from './SkipReasonsList';\n\nconst popoverPosition = {\n  marginThreshold: 0,\n  anchorOrigin: { horizontal: 'center', vertical: 'bottom' },\n  transformOrigin: { horizontal: 'center', vertical: 'bottom' },\n};\n\n// TODO not hardcode these maybe?\nconst reasons = [\n  'genre',\n  'history',\n  'unavailable',\n  'nsfw',\n  'duration',\n  'downvotes',\n  'other',\n];\n\nclass SkipButton extends React.Component {\n  static propTypes = {\n    t: PropTypes.func.isRequired,\n    userIsDJ: PropTypes.bool.isRequired,\n    currentDJ: PropTypes.object.isRequired,\n    onSkip: PropTypes.func.isRequired,\n  };\n\n  state = {\n    isSkipping: false,\n    isOpen: false,\n    anchor: null,\n  };\n\n  handleOpen = (event) => {\n    if (this.props.userIsDJ) {\n      this.handleSkip('');\n      return;\n    }\n\n    this.setState({\n      isOpen: true,\n      anchor: event.currentTarget,\n    });\n  };\n\n  handleClose = () => {\n    this.setState({\n      isOpen: false,\n    });\n  };\n\n  handleSkip = (reason) => {\n    this.setState({ isSkipping: true });\n    Promise.resolve(this.props.onSkip(reason)).then(() => {\n      this.setState({ isSkipping: false });\n    });\n    this.handleClose();\n  };\n\n  render() {\n    const { t } = this.props;\n\n    if (this.state.isSkipping) {\n      return (\n        <span>\n          <div className=\"SkipButton is-loading\">\n            <CircularProgress className=\"SkipButton-loader\" />\n          </div>\n        </span>\n      );\n    }\n\n    let message = t('booth.skip.self');\n    if (!this.props.userIsDJ) {\n      message = t('booth.skip.other', { user: this.props.currentDJ.username });\n    }\n\n    return (\n      <span>\n        <Tooltip title={message}>\n          <IconButton className=\"SkipButton\" onClick={this.handleOpen}>\n            <SkipIcon />\n          </IconButton>\n        </Tooltip>\n        <Popover\n          open={this.state.isOpen}\n          anchorEl={this.state.anchor}\n          onClose={this.handleClose}\n          classes={{ paper: 'SkipButton-list' }}\n          {...popoverPosition}\n        >\n          <SkipReasonsList\n            reasons={reasons.map(name => ({\n              name,\n              label: t(`booth.skip.reasons.${name}`),\n            }))}\n            onSelect={this.handleSkip}\n          />\n        </Popover>\n      </span>\n    );\n  }\n}\n\nexport default compose(\n  translate(),\n  pure,\n)(SkipButton);\n"],"file":"SkipButton.js"}