{"version":3,"sources":["components/Dialogs/EditMediaDialog/index.js"],"names":["cx","React","PropTypes","translate","Dialog","IconButton","uniqueId","formatDuration","ArtistIcon","TitleIcon","StartIcon","EndIcon","SwapArtistTitleIcon","Form","FormGroup","Button","TextField","parseDuration","str","split","map","parseInt","part","trim","reduce","duration","enhance","EditMediaDialog","state","errors","artist","props","media","title","start","end","labelStart","labelEnd","handleSubmit","e","preventDefault","onEditedMedia","onCloseDialog","startSeconds","endSeconds","Number","isNaN","push","length","setState","handleChangeArtist","event","target","value","handleChangeTitle","handleChangeStart","handleChangeEnd","handleSwapArtistTitle","render","t","open","bodyClassName","contentClassName","titleClassName","baseTabIndex","content","artistInput","artistTitleLabel","titleInput","fromLabel","fromInput","toLabel","toInput","error","Component","propTypes","func","isRequired","bool","object","string"],"mappings":"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","file":"index.js","sourcesContent":["import cx from 'classnames';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { translate } from 'react-i18next';\nimport Dialog from 'material-ui/Dialog';\nimport IconButton from 'material-ui/IconButton';\nimport uniqueId from 'lodash/uniqueId';\nimport formatDuration from 'format-duration';\nimport ArtistIcon from 'material-ui/svg-icons/hardware/headset';\nimport TitleIcon from 'material-ui/svg-icons/image/music-note';\nimport StartIcon from 'material-ui/svg-icons/av/play-arrow';\nimport EndIcon from 'material-ui/svg-icons/av/stop';\nimport SwapArtistTitleIcon from 'material-ui/svg-icons/action/swap-horiz';\nimport Form from '../../Form';\nimport FormGroup from '../../Form/Group';\nimport Button from '../../Form/Button';\nimport TextField from '../../Form/TextField';\n\n// naive HH:mm:ss â†’ seconds\nconst parseDuration = str => str.split(':')\n  .map(part => parseInt(part.trim(), 10))\n  .reduce((duration, part) => (duration * 60) + part, 0);\n\nconst enhance = translate();\n\nclass EditMediaDialog extends React.Component {\n  static propTypes = {\n    t: PropTypes.func.isRequired,\n    open: PropTypes.bool,\n    media: PropTypes.object,\n\n    bodyClassName: PropTypes.string,\n    contentClassName: PropTypes.string,\n    titleClassName: PropTypes.string,\n\n    onEditedMedia: PropTypes.func.isRequired,\n    onCloseDialog: PropTypes.func.isRequired\n  };\n\n  state = {\n    errors: null,\n    artist: this.props.media.artist,\n    title: this.props.media.title,\n    start: formatDuration(this.props.media.start * 1000),\n    end: formatDuration(this.props.media.end * 1000)\n  };\n\n  labelStart = uniqueId('editmedia');\n  labelEnd = uniqueId('editmedia');\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n\n    const { media, onEditedMedia, onCloseDialog } = this.props;\n    const {\n      artist, title, start, end\n    } = this.state;\n\n    const startSeconds = parseDuration(start);\n    const endSeconds = parseDuration(end);\n\n    const errors = [];\n    if (Number.isNaN(startSeconds) || startSeconds < 0) {\n      errors.push('invalidStartTime');\n    }\n    if (Number.isNaN(endSeconds) || endSeconds < 0) {\n      errors.push('invalidEndTime');\n    } else if (endSeconds < startSeconds) {\n      errors.push('endTimeBeforeStart');\n    } else if (endSeconds > media.duration) {\n      errors.push('endTimeAfterSongEnd');\n    }\n\n    if (errors.length > 0) {\n      this.setState({ errors });\n      return;\n    }\n\n    onEditedMedia({\n      artist,\n      title,\n      start: startSeconds,\n      end: endSeconds\n    });\n    onCloseDialog();\n  };\n\n  handleChangeArtist = (event) => {\n    this.setState({ artist: event.target.value });\n  };\n\n  handleChangeTitle = (event) => {\n    this.setState({ title: event.target.value });\n  };\n\n  handleChangeStart = (event) => {\n    this.setState({ start: event.target.value });\n  };\n\n  handleChangeEnd = (event) => {\n    this.setState({ end: event.target.value });\n  };\n\n  handleSwapArtistTitle = () => {\n    this.setState({\n      artist: this.state.title,\n      title: this.state.artist\n    });\n  };\n\n  render() {\n    const {\n      t,\n      open,\n      media,\n      onCloseDialog,\n\n      bodyClassName,\n      contentClassName,\n      titleClassName,\n\n      ...props\n    } = this.props;\n    const {\n      errors,\n      artist,\n      title,\n      start,\n      end\n    } = this.state;\n    const baseTabIndex = 1000;\n    let content = null;\n    if (open) {\n      const artistInput = (\n        <TextField\n          className=\"EditMediaDialogGroup-field\"\n          placeholder={t([ 'dialogs.editMedia.artistLabel', 'media.artist' ])}\n          value={artist}\n          onChange={this.handleChangeArtist}\n          icon={<ArtistIcon color=\"#9f9d9e\" />}\n          tabIndex={baseTabIndex}\n          autoFocus\n        />\n      );\n      const artistTitleLabel = (\n        <div className=\"EditMediaDialogGroup-label\">\n          <IconButton onClick={this.handleSwapArtistTitle}>\n            <SwapArtistTitleIcon color=\"#9f9d9e\" />\n          </IconButton>\n        </div>\n      );\n      const titleInput = (\n        <TextField\n          className=\"EditMediaDialogGroup-field\"\n          placeholder={t([ 'dialogs.editMedia.titleLabel', 'media.title' ])}\n          value={title}\n          onChange={this.handleChangeTitle}\n          icon={<TitleIcon color=\"#9f9d9e\" />}\n          tabIndex={baseTabIndex + 1}\n        />\n      );\n\n      const fromLabel = (\n        // eslint-disable-next-line jsx-a11y/label-has-for\n        <label htmlFor={this.labelStart} className=\"EditMediaDialogGroup-label\">\n          {t('dialogs.editMedia.playFromLabel')}\n        </label>\n      );\n      const fromInput = (\n        <TextField\n          id={this.labelStart}\n          className=\"EditMediaDialogGroup-field\"\n          placeholder=\"0:00\"\n          value={start}\n          onChange={this.handleChangeStart}\n          icon={<StartIcon color=\"#9f9d9e\" />}\n          tabIndex={baseTabIndex + 2}\n        />\n      );\n      const toLabel = (\n        // eslint-disable-next-line jsx-a11y/label-has-for\n        <label htmlFor={this.labelEnd} className=\"EditMediaDialogGroup-label\">\n          {t('dialogs.editMedia.playToLabel')}\n        </label>\n      );\n      const toInput = (\n        <TextField\n          id={this.labelEnd}\n          className=\"EditMediaDialogGroup-field\"\n          placeholder={formatDuration(media.duration)}\n          value={end}\n          onChange={this.handleChangeEnd}\n          icon={<EndIcon color=\"#9f9d9e\" />}\n          tabIndex={baseTabIndex + 3}\n        />\n      );\n\n      content = (\n        <Form className=\"EditMediaDialog\" onSubmit={this.handleSubmit}>\n          {errors && errors.length > 0 && (\n            <FormGroup>\n              {errors.map(error => <div>{t(`dialogs.editMedia.errors.${error}`)}</div>)}\n            </FormGroup>\n          )}\n\n          <div className=\"EditMediaDialogForm\">\n            <div className=\"EditMediaDialogForm-column\">\n              <FormGroup className=\"EditMediaDialogGroup\">\n                {artistInput}\n              </FormGroup>\n              <FormGroup className=\"EditMediaDialogGroup\">\n                {fromLabel}\n                {fromInput}\n              </FormGroup>\n            </div>\n            <div className=\"EditMediaDialogForm-separator\">\n              <FormGroup className=\"EditMediaDialogGroup\">\n                {artistTitleLabel}\n              </FormGroup>\n              <FormGroup className=\"EditMediaDialogGroup\">\n                {toLabel}\n              </FormGroup>\n            </div>\n            <div className=\"EditMediaDialogForm-column\">\n              <FormGroup className=\"EditMediaDialogGroup\">\n                {titleInput}\n              </FormGroup>\n              <FormGroup className=\"EditMediaDialogGroup\">\n                {toInput}\n              </FormGroup>\n            </div>\n          </div>\n\n          <FormGroup className=\"FormGroup--noSpacing\">\n            <Button className=\"EditMediaDialog-submit\">\n              {t('dialogs.editMedia.save')}\n            </Button>\n          </FormGroup>\n        </Form>\n      );\n    }\n    return (\n      <Dialog\n        {...props}\n        contentClassName={cx('Dialog', contentClassName)}\n        bodyClassName={cx('Dialog-body', bodyClassName)}\n        titleClassName={cx('Dialog-title', titleClassName)}\n        title={t('dialogs.editMedia.title')}\n        open={open}\n        onRequestClose={onCloseDialog}\n      >\n        {content}\n      </Dialog>\n    );\n  }\n}\n\nexport default enhance(EditMediaDialog);\n"]}