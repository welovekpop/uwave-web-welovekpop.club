{"version":3,"sources":["selectors/boothSelectors.js"],"names":["createSelector","isPreviewMediaDialogOpenSelector","isMutedSelector","volumeSelector","currentTimeSelector","currentUserSelector","currentUserHasRoleSelector","usersSelector","baseSelector","state","booth","historyIDSelector","historyID","mediaSelector","media","startTimeSelector","startTime","mediaDurationSelector","end","start","endTimeSelector","duration","timeElapsedSelector","currentTime","Math","max","timeRemainingSelector","elapsed","mediaProgressSelector","min","djSelector","users","djID","isCurrentDJSelector","dj","me","_id","canSkipSelector","isCurrentDJ","hasRole","playbackVolumeSelector","volume","isMuted","isPreviewMediaDialogOpen"],"mappings":"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","sourcesContent":["import { createSelector } from 'reselect';\n\nimport { isPreviewMediaDialogOpenSelector } from './dialogSelectors';\nimport { isMutedSelector, volumeSelector } from './settingSelectors';\nimport { currentTimeSelector } from './timeSelectors';\nimport {\n  currentUserSelector,\n  currentUserHasRoleSelector,\n  usersSelector,\n} from './userSelectors';\n\nconst baseSelector = state => state.booth;\n\nexport const historyIDSelector = createSelector(baseSelector, booth => booth.historyID);\nexport const mediaSelector = createSelector(baseSelector, booth => booth.media);\nexport const startTimeSelector = createSelector(baseSelector, booth => booth.startTime || 0);\n\nexport const mediaDurationSelector = createSelector(\n  mediaSelector,\n  media => (media ? media.end - media.start : 0),\n);\n\nexport const endTimeSelector = createSelector(\n  startTimeSelector,\n  mediaDurationSelector,\n  (startTime, duration) => startTime + (duration * 1000) || 0,\n);\n\nexport const timeElapsedSelector = createSelector(\n  startTimeSelector,\n  currentTimeSelector,\n  // in seconds! because media duration is in seconds, too.\n  (startTime, currentTime) => (startTime ? Math.max((currentTime - startTime) / 1000, 0) : 0),\n);\n\nexport const timeRemainingSelector = createSelector(\n  mediaDurationSelector,\n  timeElapsedSelector,\n  (duration, elapsed) => (duration > 0 ? duration - elapsed : 0),\n);\n\nexport const mediaProgressSelector = createSelector(\n  mediaDurationSelector,\n  timeElapsedSelector,\n  (duration, elapsed) => (\n    duration\n      // Ensure that the result is between 0 and 1\n      ? Math.max(0, Math.min(1, elapsed / duration))\n      : 0\n  ),\n);\n\nexport const djSelector = createSelector(\n  baseSelector,\n  usersSelector,\n  (booth, users) => users[booth.djID],\n);\n\nexport const isCurrentDJSelector = createSelector(\n  djSelector,\n  currentUserSelector,\n  (dj, me) => (\n    dj && me ? dj._id === me._id : false\n  ),\n);\n\nexport const canSkipSelector = createSelector(\n  historyIDSelector,\n  isCurrentDJSelector,\n  currentUserHasRoleSelector,\n  (historyID, isCurrentDJ, hasRole) => {\n    if (!historyID) {\n      return false;\n    }\n    return isCurrentDJ ? hasRole('booth.skip.self') : hasRole('booth.skip.other');\n  },\n);\n\nexport const playbackVolumeSelector = createSelector(\n  volumeSelector,\n  isMutedSelector,\n  isPreviewMediaDialogOpenSelector,\n  (volume, isMuted, isPreviewMediaDialogOpen) =>\n    (isMuted || isPreviewMediaDialogOpen ? 0 : volume),\n);\n"],"file":"boothSelectors.js"}