{"version":3,"sources":["selectors/waitlistSelectors.js"],"names":["createSelector","createStructuredSelector","timeRemainingSelector","djSelector","isCurrentDJSelector","currentUserSelector","usersSelector","baseSelector","state","waitlist","isLockedSelector","wl","locked","waitlistIDsSelector","sizeSelector","list","length","waitlistUsersSelector","ids","users","map","id","djAndWaitlistUsersSelector","dj","positionSelector","user","indexOf","_id","userInWaitlistSelector","position","isDJ","waitlistSelector","averagePlayDuration","baseEtaSelector","size","etaSelector","eta","remaining"],"mappings":"AAAA,SAASA,cAAT,EAAyBC,wBAAzB,QAAyD,UAAzD;AACA,SAASC,qBAAT,EAAgCC,UAAhC,EAA4CC,mBAA5C,QAAuE,kBAAvE;AACA,SAASC,mBAAT,EAA8BC,aAA9B,QAAmD,iBAAnD;;AAEA,IAAMC,eAAe,SAAfA,YAAe;AAAA,SAASC,MAAMC,QAAf;AAAA,CAArB;;AAEA,OAAO,IAAMC,mBAAmBV,eAAeO,YAAf,EAA6B;AAAA,SAAM,CAAC,CAACI,GAAGC,MAAX;AAAA,CAA7B,CAAzB;AACP,IAAMC,sBAAsBb,eAAeO,YAAf,EAA6B;AAAA,SAAMI,GAAGF,QAAT;AAAA,CAA7B,CAA5B;;AAEA,OAAO,IAAMK,eAAed,eAC1Ba,mBAD0B,EAE1B;AAAA,SAAQE,KAAKC,MAAb;AAAA,CAF0B,CAArB;;AAKP,OAAO,IAAMC,wBAAwBjB,eACnCa,mBADmC,EAEnCP,aAFmC,EAGnC,UAACY,GAAD,EAAMC,KAAN;AAAA,SAAgBD,IAAIE,GAAJ,CAAQ;AAAA,WAAMD,MAAME,EAAN,CAAN;AAAA,GAAR,CAAhB;AAAA,CAHmC,CAA9B;;AAMP,OAAO,IAAMC,6BAA6BtB,eACxCG,UADwC,EAExCc,qBAFwC,EAGxC,UAACM,EAAD,EAAKd,QAAL;AAAA,SAAmBc,MAAMA,EAAN,SAAad,QAAb,IAAyBA,QAA5C;AAAA,CAHwC,CAAnC;;AAMP,OAAO,IAAMe,mBAAmBxB,eAC9Ba,mBAD8B,EAE9BR,mBAF8B,EAG9B,UAACa,GAAD,EAAMO,IAAN,EAAe;AACb,MAAI,CAACA,IAAL,EAAW,OAAO,CAAC,CAAR;AACX,SAAOP,IAAIQ,OAAJ,CAAYD,KAAKE,GAAjB,CAAP;AACD,CAN6B,CAAzB;;AASP,OAAO,IAAMC,yBAAyB5B,eACpCwB,gBADoC,EAEpCpB,mBAFoC,EAGpC,UAACyB,QAAD,EAAWC,IAAX;AAAA,SAAoBD,aAAa,CAAC,CAAd,IAAmBC,IAAvC;AAAA,CAHoC,CAA/B;;AAMP,OAAO,IAAMC,mBAAmB9B,yBAAyB;AACvDW,UAAQF,gBAD+C;AAEvDS,SAAOF;AAFgD,CAAzB,CAAzB;;AAKP;AACA,IAAMe,sBAAsB,IAAI,EAAJ,GAAS,IAArC;AACA,OAAO,IAAMC,kBAAkBjC,eAC7BwB,gBAD6B,EAE7BV,YAF6B,EAG7B,UAACe,QAAD,EAAWK,IAAX;AAAA,SACE,CAACL,aAAa,CAAC,CAAd,GAAkBK,IAAlB,GAAyBL,QAA1B,IAAsCG,mBADxC;AAAA,CAH6B,CAAxB;;AAOP,OAAO,IAAMG,cAAcnC,eACzBiC,eADyB,EAEzB/B,qBAFyB,EAGzB,UAACkC,GAAD,EAAMC,SAAN;AAAA,SAAoBD,MAAMC,SAA1B;AAAA,CAHyB,CAApB","file":"waitlistSelectors.js","sourcesContent":["import { createSelector, createStructuredSelector } from 'reselect';\nimport { timeRemainingSelector, djSelector, isCurrentDJSelector } from './boothSelectors';\nimport { currentUserSelector, usersSelector } from './userSelectors';\n\nconst baseSelector = state => state.waitlist;\n\nexport const isLockedSelector = createSelector(baseSelector, wl => !!wl.locked);\nconst waitlistIDsSelector = createSelector(baseSelector, wl => wl.waitlist);\n\nexport const sizeSelector = createSelector(\n  waitlistIDsSelector,\n  list => list.length,\n);\n\nexport const waitlistUsersSelector = createSelector(\n  waitlistIDsSelector,\n  usersSelector,\n  (ids, users) => ids.map(id => users[id]),\n);\n\nexport const djAndWaitlistUsersSelector = createSelector(\n  djSelector,\n  waitlistUsersSelector,\n  (dj, waitlist) => (dj ? [dj, ...waitlist] : waitlist),\n);\n\nexport const positionSelector = createSelector(\n  waitlistIDsSelector,\n  currentUserSelector,\n  (ids, user) => {\n    if (!user) return -1;\n    return ids.indexOf(user._id);\n  },\n);\n\nexport const userInWaitlistSelector = createSelector(\n  positionSelector,\n  isCurrentDJSelector,\n  (position, isDJ) => position !== -1 || isDJ,\n);\n\nexport const waitlistSelector = createStructuredSelector({\n  locked: isLockedSelector,\n  users: waitlistUsersSelector,\n});\n\n// Most videos come in at around 4 minutes.\nconst averagePlayDuration = 4 * 60 * 1000;\nexport const baseEtaSelector = createSelector(\n  positionSelector,\n  sizeSelector,\n  (position, size) =>\n    (position === -1 ? size : position) * averagePlayDuration,\n);\n\nexport const etaSelector = createSelector(\n  baseEtaSelector,\n  timeRemainingSelector,\n  (eta, remaining) => eta + remaining,\n);\n"]}