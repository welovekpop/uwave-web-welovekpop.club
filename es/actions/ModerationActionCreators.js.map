{"version":3,"sources":["actions/ModerationActionCreators.js"],"names":["djSelector","SKIP_DJ_START","SKIP_DJ_COMPLETE","MOVE_USER_START","MOVE_USER_COMPLETE","REMOVE_USER_START","REMOVE_USER_COMPLETE","MUTE_USER_START","MUTE_USER_COMPLETE","UNMUTE_USER_START","UNMUTE_USER_COMPLETE","BAN_USER_START","BAN_USER_COMPLETE","SET_USER_ROLE_START","SET_USER_ROLE_COMPLETE","removeMessage","removeMessagesByUser","removeAllMessages","del","post","put","skipCurrentDJ","reason","shouldRemove","dispatch","getState","dj","payload","userID","_id","remove","onStart","type","onComplete","onError","error","meta","removeCurrentDJ","removeWaitlistUserStart","user","removeWaitlistUserComplete","removeWaitlistUser","currentDJ","promise","then","catch","moveWaitlistUserStart","position","moveWaitlistUserComplete","moveWaitlistUser","setUserRoleStart","role","setUserRoleComplete","setUserRole","deleteChatMessage","id","undefined","deleteChatMessagesByUser","deleteAllChatMessages","muteUserStart","duration","muteUserComplete","muteUser","time","unmuteUserStart","unmuteUserComplete","unmuteUser","banUserStart","permanent","banUserComplete","ban","banUser","data"],"mappings":"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","file":"ModerationActionCreators.js","sourcesContent":["import { djSelector } from '../selectors/boothSelectors';\n\nimport {\n  SKIP_DJ_START, SKIP_DJ_COMPLETE,\n  MOVE_USER_START, MOVE_USER_COMPLETE,\n  REMOVE_USER_START, REMOVE_USER_COMPLETE,\n  MUTE_USER_START, MUTE_USER_COMPLETE,\n  UNMUTE_USER_START, UNMUTE_USER_COMPLETE,\n  BAN_USER_START, BAN_USER_COMPLETE,\n  SET_USER_ROLE_START, SET_USER_ROLE_COMPLETE\n} from '../constants/actionTypes/moderation';\n\nimport {\n  removeMessage, removeMessagesByUser, removeAllMessages\n} from './ChatActionCreators';\nimport {\n  del, post, put\n} from './RequestActionCreators';\n\nexport function skipCurrentDJ(reason = '', shouldRemove = false) {\n  return (dispatch, getState) => {\n    const dj = djSelector(getState());\n    if (!dj) {\n      return null;\n    }\n    const payload = {\n      userID: dj._id,\n      reason,\n      remove: shouldRemove\n    };\n    return dispatch(post('/booth/skip', payload, {\n      onStart: () => ({ type: SKIP_DJ_START, payload }),\n      onComplete: () => ({ type: SKIP_DJ_COMPLETE, payload }),\n      onError: error => ({\n        type: SKIP_DJ_COMPLETE,\n        error: true,\n        payload: error,\n        meta: payload\n      })\n    }));\n  };\n}\n\nexport function removeCurrentDJ(reason = '') {\n  return skipCurrentDJ(reason, true);\n}\n\nexport function removeWaitlistUserStart(user) {\n  return {\n    type: REMOVE_USER_START,\n    payload: { user }\n  };\n}\n\nexport function removeWaitlistUserComplete(user) {\n  return {\n    type: REMOVE_USER_COMPLETE,\n    payload: { user }\n  };\n}\n\nexport function removeWaitlistUser(user) {\n  return (dispatch, getState) => {\n    dispatch(removeWaitlistUserStart(user));\n\n    const currentDJ = djSelector(getState());\n    let promise;\n    if (currentDJ && currentDJ._id === user._id) {\n      promise = dispatch(removeCurrentDJ());\n    } else {\n      promise = dispatch(del(`/waitlist/${user._id}`));\n    }\n\n    return promise\n      .then(() => dispatch(removeWaitlistUserComplete(user)))\n      .catch(error => dispatch({\n        type: REMOVE_USER_COMPLETE,\n        error: true,\n        payload: error\n      }));\n  };\n}\n\nexport function moveWaitlistUserStart(user, position) {\n  return {\n    type: MOVE_USER_START,\n    payload: { user, position }\n  };\n}\n\nexport function moveWaitlistUserComplete(user, position) {\n  return {\n    type: MOVE_USER_COMPLETE,\n    payload: { user, position }\n  };\n}\n\nexport function moveWaitlistUser(user, position) {\n  return put('/waitlist/move', { userID: user._id, position }, {\n    onStart: () => moveWaitlistUserStart(user, position),\n    onComplete: () => moveWaitlistUserComplete(user, position),\n    onError: error => ({\n      type: MOVE_USER_COMPLETE,\n      error: true,\n      payload: error,\n      meta: { user, position }\n    })\n  });\n}\n\nexport function setUserRoleStart(user, role) {\n  return {\n    type: SET_USER_ROLE_START,\n    payload: { user, role }\n  };\n}\n\nexport function setUserRoleComplete(user, role) {\n  return {\n    type: SET_USER_ROLE_COMPLETE,\n    payload: { user, role }\n  };\n}\n\nexport function setUserRole(user, role) {\n  const userID = typeof user === 'object' ? user._id : user;\n  return put(`/users/${userID}/role`, { role }, {\n    onStart: () => setUserRoleStart(user, role),\n    onComplete: () => setUserRoleComplete(user, role),\n    onError: error => ({\n      type: SET_USER_ROLE_COMPLETE,\n      error: true,\n      payload: error,\n      meta: { user, role }\n    })\n  });\n}\n\nexport function deleteChatMessage(id) {\n  return del(`/chat/${id}`, {}, {\n    onStart: () => removeMessage(id),\n    onError: error => ({\n      type: undefined,\n      error: true,\n      payload: error,\n      meta: { id }\n    })\n  });\n}\n\nexport function deleteChatMessagesByUser(userID) {\n  return del(`/chat/user/${userID}`, {}, {\n    onComplete: () => removeMessagesByUser(userID),\n    onError: error => ({\n      type: undefined,\n      error: true,\n      payload: error,\n      meta: { userID }\n    })\n  });\n}\n\nexport function deleteAllChatMessages() {\n  return del('/chat', {}, {\n    onComplete: removeAllMessages,\n    onError: error => ({\n      type: undefined,\n      error: true,\n      payload: error\n    })\n  });\n}\n\nexport function muteUserStart(userID, duration) {\n  return {\n    type: MUTE_USER_START,\n    payload: { userID, duration }\n  };\n}\n\nexport function muteUserComplete(userID, duration) {\n  return {\n    type: MUTE_USER_COMPLETE,\n    payload: { userID, duration }\n  };\n}\n\n/**\n * Mute a user in the chat. Defaults to 10 minutes.\n */\nexport function muteUser(user, duration = 10 * 60 * 1000) {\n  const userID = typeof user === 'object' ? user._id : user;\n  return post(`/users/${userID}/mute`, { time: duration }, {\n    onStart: () => muteUserStart(userID, duration),\n    onComplete: () => muteUserComplete(userID, duration),\n    onError: error => ({\n      type: MUTE_USER_COMPLETE,\n      error: true,\n      payload: error\n    })\n  });\n}\n\nexport function unmuteUserStart(userID) {\n  return {\n    type: UNMUTE_USER_START,\n    payload: { userID }\n  };\n}\n\nexport function unmuteUserComplete(userID) {\n  return {\n    type: UNMUTE_USER_COMPLETE,\n    payload: { userID }\n  };\n}\n\nexport function unmuteUser(user) {\n  const userID = typeof user === 'object' ? user._id : user;\n  return del(`/users/${userID}/mute`, {}, {\n    onStart: () => unmuteUserStart(userID),\n    onComplete: () => unmuteUserComplete(userID),\n    onError: error => ({\n      type: UNMUTE_USER_COMPLETE,\n      error: true,\n      payload: error\n    })\n  });\n}\n\nexport function banUserStart(userID, duration, permanent) {\n  return {\n    type: BAN_USER_START,\n    payload: { userID, duration, permanent }\n  };\n}\n\nexport function banUserComplete(ban) {\n  return {\n    type: BAN_USER_COMPLETE,\n    payload: ban\n  };\n}\n\n/**\n * Ban a user. Defaults to 24 hours.\n */\nexport function banUser(user, { duration = 24 * 60 * 60 * 1000, permanent = false }) {\n  const userID = typeof user === 'object' ? user._id : user;\n  return post('/bans', { userID, duration, permanent }, {\n    onStart: () => banUserStart(userID, duration, permanent),\n    onComplete: ({ data }) => banUserComplete(data),\n    onError: error => ({\n      type: BAN_USER_COMPLETE,\n      error: true,\n      payload: error\n    })\n  });\n}\n"]}