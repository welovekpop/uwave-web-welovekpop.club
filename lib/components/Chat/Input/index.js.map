{"version":3,"sources":["components/Chat/Input/index.js"],"names":["renderSuggestions","children","getUserCompletions","value","_ref","trigger","completions","compare","substr","length","toLowerCase","filter","user","username","getUserText","_ref2","renderUser","props","createElement","renderGroup","getEmojiCompletions","_ref3","results","emoji","shortcode","image","getEmojiText","renderEmoji","enhance","ChatInput","_React$Component","_temp","_this","_ret","_len","arguments","args","Array","_key","call","apply","concat","state","focused","handleFocus","setState","handleBlur","handleKeyDown","e","stopPropagation","key","target","trim","onSend","clear","handleUpdate","newValue","prototype","render","_state","_props","t","mentionableUsers","mentionableGroups","availableEmoji","focusClass","className","inputProps","type","placeholder","onFocus","onBlur","onKeyDown","onUpdate","limit","minLength","getCompletions","getText","renderSuggestion","Component","propTypes","process","env","NODE_ENV","func","isRequired","array"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAIA,oBAAoB,SAASA,iBAAT,CAA2BC,QAA3B,EAAqC;AAC3D,SAAO,8CAAsB,EAAtB,EAA0B,KAAK,CAA/B,EAAkCA,QAAlC,CAAP;AACD,CAFD;;AAIA;AACA,IAAIC,qBAAqB,SAASA,kBAAT,CAA4BC,KAA5B,EAAmCC,IAAnC,EAAyC;AAChE,MAAIC,UAAUD,KAAKC,OAAnB;AAAA,MACIC,cAAcF,KAAKE,WADvB;;AAGA,MAAIC,UAAUJ,MAAMK,MAAN,CAAaH,QAAQI,MAArB,EAA6BC,WAA7B,EAAd;AACA,SAAOJ,YAAYK,MAAZ,CAAmB,UAAUC,IAAV,EAAgB;AACxC,WAAOA,KAAKC,QAAL,CAAcL,MAAd,CAAqB,CAArB,EAAwBD,QAAQE,MAAhC,EAAwCC,WAAxC,OAA0DH,OAAjE;AACD,GAFM,CAAP;AAGD,CARD;AASA,IAAIO,cAAc,SAASA,WAAT,CAAqBF,IAArB,EAA2BG,KAA3B,EAAkC;AAClD,MAAIV,UAAUU,MAAMV,OAApB;AACA,SAAO,KAAKA,OAAL,GAAeO,KAAKC,QAApB,GAA+B,GAAtC;AACD,CAHD;AAIA,IAAIG,aAAa,SAASA,UAAT,CAAoBC,KAApB,EAA2B;AAC1C,SAAO,gBAAMC,aAAN,2BAAoCD,KAApC,CAAP;AACD,CAFD;;AAIA;AACA,IAAIE,cAAc,SAASA,WAAT,CAAqBF,KAArB,EAA4B;AAC5C,SAAO,gBAAMC,aAAN,4BAAqCD,KAArC,CAAP;AACD,CAFD;;AAIA;AACA,IAAIG,sBAAsB,SAASA,mBAAT,CAA6BjB,KAA7B,EAAoCkB,KAApC,EAA2C;AACnE,MAAIhB,UAAUgB,MAAMhB,OAApB;AAAA,MACIC,cAAce,MAAMf,WADxB;;AAGA,MAAIC,UAAUJ,MAAMK,MAAN,CAAaH,QAAQI,MAArB,EAA6BC,WAA7B,EAAd;AACA,MAAIY,UAAUhB,YAAYK,MAAZ,CAAmB,UAAUY,KAAV,EAAiB;AAChD,WAAOA,MAAMC,SAAN,CAAgBhB,MAAhB,CAAuB,CAAvB,EAA0BD,QAAQE,MAAlC,EAA0CC,WAA1C,OAA4DH,OAAnE;AACD,GAFa,CAAd;AAGA,SAAO,sBAAO,sBAAOe,OAAP,EAAgB,UAAUC,KAAV,EAAiB;AAC7C,WAAOA,MAAME,KAAb;AACD,GAFa,CAAP,EAEH,UAAUF,KAAV,EAAiB;AACnB,WAAOA,MAAMC,SAAN,CAAgBf,MAAvB;AACD,GAJM,CAAP;AAKD,CAbD;AAcA,IAAIiB,eAAe,SAASA,YAAT,CAAsBvB,KAAtB,EAA6B;AAC9C,SAAO,MAAMA,MAAMqB,SAAZ,GAAwB,IAA/B;AACD,CAFD;AAGA,IAAIG,cAAc,SAASA,WAAT,CAAqBV,KAArB,EAA4B;AAC5C,SAAO,gBAAMC,aAAN,4BAAqCD,KAArC,CAAP;AACD,CAFD;;AAIA,IAAIW,UAAU,8BAAd;;AAEA,IAAIC,YAAY,UAAUC,gBAAV,EAA4B;AAC1C,0BAAUD,SAAV,EAAqBC,gBAArB;;AAEA,WAASD,SAAT,GAAqB;AACnB,QAAIE,KAAJ,EAAWC,KAAX,EAAkBC,IAAlB;;AAEA,kCAAgB,IAAhB,EAAsBJ,SAAtB;;AAEA,SAAK,IAAIK,OAAOC,UAAU1B,MAArB,EAA6B2B,OAAOC,MAAMH,IAAN,CAApC,EAAiDI,OAAO,CAA7D,EAAgEA,OAAOJ,IAAvE,EAA6EI,MAA7E,EAAqF;AACnFF,WAAKE,IAAL,IAAaH,UAAUG,IAAV,CAAb;AACD;;AAED,WAAOL,QAAQF,SAASC,QAAQ,yCAA2B,IAA3B,EAAiCF,iBAAiBS,IAAjB,CAAsBC,KAAtB,CAA4BV,gBAA5B,EAA8C,CAAC,IAAD,EAAOW,MAAP,CAAcL,IAAd,CAA9C,CAAjC,CAAR,EAA8GJ,KAAvH,GAA+HA,MAAMU,KAAN,GAAc;AAC1JC,eAAS,KADiJ;AAE1JxC,aAAO;AAFmJ,KAA7I,EAGZ6B,MAAMY,WAAN,GAAoB,YAAY;AACjCZ,YAAMa,QAAN,CAAe,EAAEF,SAAS,IAAX,EAAf;AACD,KALc,EAKZX,MAAMc,UAAN,GAAmB,YAAY;AAChCd,YAAMa,QAAN,CAAe,EAAEF,SAAS,KAAX,EAAf;AACD,KAPc,EAOZX,MAAMe,aAAN,GAAsB,UAAUC,CAAV,EAAa;AACpCA,QAAEC,eAAF;AACA,UAAID,EAAEE,GAAF,KAAU,OAAd,EAAuB;AACrB,YAAI/C,QAAQ6C,EAAEG,MAAF,CAAShD,KAAT,CAAeiD,IAAf,EAAZ;AACA,YAAIjD,MAAMM,MAAN,GAAe,CAAnB,EAAsB;AACpBuB,gBAAMf,KAAN,CAAYoC,MAAZ,CAAmBlD,KAAnB;AACD;AACD6B,cAAMsB,KAAN;AACD;AACF,KAhBc,EAgBZtB,MAAMuB,YAAN,GAAqB,UAAUC,QAAV,EAAoB;AAC1CxB,YAAMa,QAAN,CAAe,EAAE1C,OAAOqD,QAAT,EAAf;AACD,KAlBc,EAkBZzB,KAlBI,GAkBI,yCAA2BC,KAA3B,EAAkCC,IAAlC,CAlBX;AAmBD;;AAEDJ,YAAU4B,SAAV,CAAoBH,KAApB,GAA4B,SAASA,KAAT,GAAiB;AAC3C,SAAKT,QAAL,CAAc,EAAE1C,OAAO,EAAT,EAAd;AACD,GAFD;;AAIA0B,YAAU4B,SAAV,CAAoBC,MAApB,GAA6B,SAASA,MAAT,GAAkB;AAC7C,QAAIC,SAAS,KAAKjB,KAAlB;AAAA,QACIC,UAAUgB,OAAOhB,OADrB;AAAA,QAEIxC,QAAQwD,OAAOxD,KAFnB;AAGA,QAAIyD,SAAS,KAAK3C,KAAlB;AAAA,QACI4C,IAAID,OAAOC,CADf;AAAA,QAEIC,mBAAmBF,OAAOE,gBAF9B;AAAA,QAGIC,oBAAoBH,OAAOG,iBAH/B;AAAA,QAIIC,iBAAiBJ,OAAOI,cAJ5B;;AAMA,QAAIC,aAAatB,UAAU,YAAV,GAAyB,EAA1C;AACA,WAAO,mBAAK,KAAL,EAAY;AACjBuB,iBAAW,0BAAG,WAAH,EAAgBD,UAAhB;AADM,KAAZ,EAEJ,KAAK,CAFD,EAEI,wDAAmB;AAC5BE,kBAAY;AACVC,cAAM,MADI;AAEVF,mBAAW,0BAAG,iBAAH,EAAsBD,UAAtB,CAFD;AAGVI,qBAAa1B,UAAU,EAAV,GAAekB,EAAE,kBAAF,CAHlB;AAIVS,iBAAS,KAAK1B,WAJJ;AAKV2B,gBAAQ,KAAKzB,UALH;AAMV0B,mBAAW,KAAKzB;AANN,OADgB;AAS5B0B,gBAAU,KAAKlB,YATa;AAU5BpD,aAAOA,KAVqB;AAW5BH,yBAAmBA,iBAXS;AAY5B0E,aAAO;AAZqB,KAAnB,EAaR,KAAK,CAbG,EAaA,0DAAiB;AAC1BrE,eAAS,GADiB;AAE1BsE,iBAAW,CAFe;AAG1BrE,mBAAawD,gBAHa;AAI1Bc,sBAAgB1E,kBAJU;AAK1B2E,eAAS/D,WALiB;AAM1BgE,wBAAkB9D;AANQ,KAAjB,CAbA,EAoBP,0DAAiB;AACnBX,eAAS,GADU;AAEnBsE,iBAAW,CAFQ;AAGnBrE,mBAAayD,iBAHM;AAInBe,wBAAkB3D;AAJC,KAAjB,CApBO,EAyBP,0DAAiB;AACnBd,eAAS,GADU;AAEnBC,mBAAa0D,cAFM;AAGnBY,sBAAgBxD,mBAHG;AAInByD,eAASnD,YAJU;AAKnBoD,wBAAkBnD;AALC,KAAjB,CAzBO,CAFJ,CAAP;AAkCD,GA7CD;;AA+CA,SAAOE,SAAP;AACD,CArFe,CAqFd,gBAAMkD,SArFQ,CAAhB;;AAuFAlD,UAAUmD,SAAV,GAAsBC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC;AAC5DtB,KAAG,oBAAUuB,IAAV,CAAeC,UAD0C;AAE5DhC,UAAQ,oBAAU+B,IAAV,CAAeC,UAFqC;AAG5DvB,oBAAkB,oBAAUwB,KAAV,CAAgBD,UAH0B;AAI5DtB,qBAAmB,oBAAUuB,KAAV,CAAgBD,UAJyB;AAK5DrB,kBAAgB,oBAAUsB,KAAV,CAAgBD;AAL4B,CAAxC,GAMlB,EANJ;;kBASezD,QAAQC,SAAR,C;AACf","file":"index.js","sourcesContent":["import cx from 'classnames';\nimport sortBy from 'lodash/sortBy';\nimport uniqBy from 'lodash/uniqBy';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { translate } from 'react-i18next';\nimport AutoComplete, { Completion } from 'react-abstract-autocomplete';\nimport SuggestionsList from './SuggestionsList';\nimport EmojiSuggestion from './EmojiSuggestion';\nimport GroupSuggestion from './GroupSuggestion';\nimport UserSuggestion from './UserSuggestion';\n\nconst renderSuggestions = children => (\n  <SuggestionsList>{children}</SuggestionsList>\n);\n\n// User suggestions:\nconst getUserCompletions = (value, { trigger, completions }) => {\n  const compare = value.substr(trigger.length).toLowerCase();\n  return completions.filter(user => (\n    user.username.substr(0, compare.length).toLowerCase() === compare\n  ));\n};\nconst getUserText = (user, { trigger }) => `${trigger}${user.username} `;\nconst renderUser = props => <UserSuggestion {...props} />;\n\n// Group suggestions:\nconst renderGroup = props => <GroupSuggestion {...props} />;\n\n// Emoji suggestions:\nconst getEmojiCompletions = (value, { trigger, completions }) => {\n  const compare = value.substr(trigger.length).toLowerCase();\n  const results = completions.filter(emoji => (\n    emoji.shortcode.substr(0, compare.length).toLowerCase() === compare\n  ));\n  return sortBy(\n    uniqBy(results, emoji => emoji.image),\n    emoji => emoji.shortcode.length\n  );\n};\nconst getEmojiText = value => `:${value.shortcode}: `;\nconst renderEmoji = props => <EmojiSuggestion {...props} />;\n\nconst enhance = translate();\n\nclass ChatInput extends React.Component {\n  static propTypes = {\n    t: PropTypes.func.isRequired,\n    onSend: PropTypes.func.isRequired,\n    mentionableUsers: PropTypes.array.isRequired,\n    mentionableGroups: PropTypes.array.isRequired,\n    availableEmoji: PropTypes.array.isRequired\n  };\n\n  state = {\n    focused: false,\n    value: ''\n  };\n\n  clear() {\n    this.setState({ value: '' });\n  }\n\n  handleFocus = () => {\n    this.setState({ focused: true });\n  };\n  handleBlur = () => {\n    this.setState({ focused: false });\n  };\n\n  handleKeyDown = (e) => {\n    e.stopPropagation();\n    if (e.key === 'Enter') {\n      const value = e.target.value.trim();\n      if (value.length > 0) {\n        this.props.onSend(value);\n      }\n      this.clear();\n    }\n  };\n\n  handleUpdate = (newValue) => {\n    this.setState({ value: newValue });\n  };\n\n  render() {\n    const {\n      focused,\n      value\n    } = this.state;\n    const {\n      t,\n      mentionableUsers,\n      mentionableGroups,\n      availableEmoji\n    } = this.props;\n    const focusClass = focused ? 'is-focused' : '';\n    return (\n      <div className={cx('ChatInput', focusClass)}>\n        <AutoComplete\n          inputProps={{\n            type: 'text',\n            className: cx('ChatInput-input', focusClass),\n            placeholder: focused ? '' : t('chat.placeholder'),\n            onFocus: this.handleFocus,\n            onBlur: this.handleBlur,\n            onKeyDown: this.handleKeyDown\n          }}\n          onUpdate={this.handleUpdate}\n          value={value}\n          renderSuggestions={renderSuggestions}\n          limit={6}\n        >\n          <Completion\n            trigger=\"@\"\n            minLength={2}\n            completions={mentionableUsers}\n            getCompletions={getUserCompletions}\n            getText={getUserText}\n            renderSuggestion={renderUser}\n          />\n          <Completion\n            trigger=\"@\"\n            minLength={2}\n            completions={mentionableGroups}\n            renderSuggestion={renderGroup}\n          />\n          <Completion\n            trigger=\":\"\n            completions={availableEmoji}\n            getCompletions={getEmojiCompletions}\n            getText={getEmojiText}\n            renderSuggestion={renderEmoji}\n          />\n        </AutoComplete>\n      </div>\n    );\n  }\n}\n\nexport default enhance(ChatInput);\n"]}