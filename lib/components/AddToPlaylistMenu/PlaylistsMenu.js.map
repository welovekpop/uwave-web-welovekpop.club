{"version":3,"sources":["components/AddToPlaylistMenu/PlaylistsMenu.js"],"names":["MENU_HEIGHT","MENU_WIDTH","RANDOM_MUI_PADDING","SCROLLBAR_WIDTH","NEW_PLAYLIST","positionInsideWindow","position","expectedHeight","constrained","x","y","h","Math","min","w","window","innerHeight","innerWidth","menuStyle","textAlign","zIndex","menuItemStyle","WebkitAppearance","enhance","_ref","color","PlaylistsMenu","_React$Component","_temp","_this","_ret","_len","arguments","length","args","Array","_key","call","apply","concat","handleSelect","e","item","playlistID","props","value","onCreatePlaylist","onClose","onSelect","playlists","pl","_id","renderLayer","_this$props","t","fixedPosition","style","left","top","width","maxHeight","autoWidth","onItemClick","leftIcon","primaryText","map","playlist","name","secondaryText","size","checked","active","prototype","render","open","componentClickAway","Component","propTypes","process","env","NODE_ENV","func","isRequired","arrayOf","object","shape","number"],"mappings":"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","file":"PlaylistsMenu.js","sourcesContent":["import find from 'array-find';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { translate } from 'react-i18next';\nimport Paper from 'material-ui/Paper';\nimport Menu from 'material-ui/Menu';\nimport MenuItem from 'material-ui/MenuItem';\nimport CreatePlaylistIcon from 'material-ui/svg-icons/content/add';\n// ðŸ˜±\nimport RenderToLayer from 'material-ui/internal/RenderToLayer';\n\nconst MENU_HEIGHT = 320;\nconst MENU_WIDTH = 280;\n\nconst RANDOM_MUI_PADDING = 8;\nconst SCROLLBAR_WIDTH = 7;\n\nconst NEW_PLAYLIST = {};\n\nconst positionInsideWindow = (position, expectedHeight) => {\n  const constrained = { x: position.x, y: position.y };\n  const h = Math.min(expectedHeight, MENU_HEIGHT);\n  const w = MENU_WIDTH;\n  if (position.y + h >= window.innerHeight) {\n    // position at the bottom of the screen\n    constrained.y = window.innerHeight - h;\n  }\n  if (position.x + w >= window.innerWidth) {\n    // position to the left-hand side of the anchor, instead of the right-hand side\n    constrained.x -= w;\n  }\n  return constrained;\n};\n\nconst menuStyle = {\n  textAlign: 'left',\n  zIndex: 30\n};\nconst menuItemStyle = {\n  WebkitAppearance: 'initial'\n};\n\nconst enhance = translate();\n\nclass PlaylistsMenu extends React.Component {\n  static propTypes = {\n    t: PropTypes.func.isRequired,\n    onClose: PropTypes.func.isRequired,\n    onSelect: PropTypes.func.isRequired,\n    onCreatePlaylist: PropTypes.func.isRequired,\n    playlists: PropTypes.arrayOf(PropTypes.object),\n    position: PropTypes.shape({\n      x: PropTypes.number,\n      y: PropTypes.number\n    })\n  };\n\n  handleSelect = (e, item) => {\n    const playlistID = item.props.value;\n    if (playlistID === NEW_PLAYLIST) {\n      this.props.onCreatePlaylist();\n      return;\n    }\n    this.props.onClose();\n    this.props.onSelect(find(this.props.playlists, pl => pl._id === playlistID));\n  };\n\n  renderLayer = () => {\n    const { playlists, position, t } = this.props;\n    const fixedPosition = positionInsideWindow(position, (playlists.length + 1) * 48);\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          left: fixedPosition.x,\n          top: fixedPosition.y,\n          width: MENU_WIDTH + RANDOM_MUI_PADDING + SCROLLBAR_WIDTH\n        }}\n      >\n        <Paper>\n          <Menu\n            style={menuStyle}\n            maxHeight={MENU_HEIGHT}\n            width={MENU_WIDTH}\n            autoWidth={false}\n            onItemClick={this.handleSelect}\n          >\n            <MenuItem\n              style={menuItemStyle}\n              value={NEW_PLAYLIST}\n              leftIcon={<CreatePlaylistIcon color=\"#fff\" />}\n              primaryText={t('playlists.new')}\n            />\n            {playlists.map(playlist => (\n              <MenuItem\n                key={playlist._id}\n                style={menuItemStyle}\n                value={playlist._id}\n                primaryText={playlist.name}\n                secondaryText={`${playlist.size || 0}`}\n                checked={!!playlist.active}\n              />\n            ))}\n          </Menu>\n        </Paper>\n      </div>\n    );\n  };\n\n  render() {\n    const { onClose } = this.props;\n    return (\n      <RenderToLayer\n        open\n        componentClickAway={onClose}\n        render={this.renderLayer}\n      />\n    );\n  }\n}\n\nexport default enhance(PlaylistsMenu);\n"]}