{"version":3,"sources":["actions/PlaylistActionCreators.js"],"names":["setPlaylists","flattenPlaylistItem","loadPlaylistStart","loadPlaylistComplete","loadPlaylist","filterPlaylistItemsStart","filterPlaylistItemsComplete","loadFilteredPlaylistItems","filterPlaylistItems","selectPlaylist","playlistCycled","cyclePlaylist","activatePlaylistStart","activatePlaylistComplete","activatePlaylist","loadPlaylistsStart","loadPlaylistsComplete","loadPlaylists","createPlaylistStart","createPlaylistComplete","createPlaylist","renamePlaylist","deselectPlaylist","deletePlaylistStart","deletePlaylistComplete","cannotDeleteActivePlaylist","deletePlaylist","addMediaMenu","closeAddMediaMenu","addMediaStart","addMediaComplete","addMedia","editMedia","updateMediaStart","updateMediaComplete","updateMedia","removeMediaStart","removeMediaComplete","removeMedia","moveMediaStart","moveMediaComplete","moveMedia","shufflePlaylistStart","shufflePlaylistComplete","shufflePlaylist","MEDIA_PAGE_SIZE","playlists","type","payload","item","media","playlistID","page","_ref","arguments","length","undefined","_ref$sneaky","sneaky","meta","pagination","qs","limit","onStart","onComplete","res","map","offset","pageSize","size","total","onError","error","filter","dispatch","getState","results","loadAll","loadFiltered","shouldLoadAfterCycle","playlist","every","Boolean","slice","activePlaylist","selectedPlaylist","_id","data","props","tempId","name","Date","now","description","shared","isFirstPlaylist","_ref2","selectedID","activeID","Error","items","position","location","newSize","insert","afterID","appendedMedia","minimizePlaylistItem","sourceType","sourceID","artist","title","start","end","after","playlistSize","mediaID","medias","removedMedia","itemIDs","_ref3","resolveMoveOptions","opts","before","i","l","at","playlistItems","shuffleOperation","loadOperation","then"],"mappings":"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","file":"PlaylistActionCreators.js","sourcesContent":["import {\n  LOAD_ALL_PLAYLISTS_START, LOAD_ALL_PLAYLISTS_COMPLETE,\n  LOAD_PLAYLIST_START, LOAD_PLAYLIST_COMPLETE,\n  FILTER_PLAYLIST_ITEMS,\n  FILTER_PLAYLIST_ITEMS_START, FILTER_PLAYLIST_ITEMS_COMPLETE,\n  PLAYLIST_CYCLED,\n  SELECT_PLAYLIST,\n  ACTIVATE_PLAYLIST_START, ACTIVATE_PLAYLIST_COMPLETE,\n  CREATE_PLAYLIST_START, CREATE_PLAYLIST_COMPLETE,\n  RENAME_PLAYLIST_START, RENAME_PLAYLIST_COMPLETE,\n  DELETE_PLAYLIST_START, DELETE_PLAYLIST_COMPLETE,\n  OPEN_ADD_MEDIA_MENU, CLOSE_ADD_MEDIA_MENU,\n  ADD_MEDIA_START, ADD_MEDIA_COMPLETE,\n  REMOVE_MEDIA_START, REMOVE_MEDIA_COMPLETE,\n  MOVE_MEDIA_START, MOVE_MEDIA_COMPLETE,\n  UPDATE_MEDIA_START, UPDATE_MEDIA_COMPLETE,\n  SHUFFLE_PLAYLIST_START, SHUFFLE_PLAYLIST_COMPLETE,\n} from '../constants/actionTypes/playlists';\n\nimport { openEditMediaDialog } from './DialogActionCreators';\nimport { del, get, post, put } from './RequestActionCreators';\n\nimport {\n  playlistsSelector,\n  playlistItemsSelector,\n  playlistItemFilterSelector,\n  activePlaylistIDSelector,\n  selectedPlaylistIDSelector,\n  activePlaylistSelector,\n  selectedPlaylistSelector,\n} from '../selectors/playlistSelectors';\nimport mergeIncludedModels from '../utils/mergeIncludedModels';\n\nconst MEDIA_PAGE_SIZE = 50;\n\nexport function setPlaylists(playlists) {\n  return {\n    type: LOAD_ALL_PLAYLISTS_COMPLETE,\n    payload: { playlists },\n  };\n}\n\nexport function flattenPlaylistItem(item) {\n  return {\n    ...item.media,\n    ...item,\n  };\n}\n\nexport function loadPlaylistStart(playlistID, page, { sneaky = false } = {}) {\n  return {\n    type: LOAD_PLAYLIST_START,\n    payload: { playlistID },\n    meta: { page, sneaky },\n  };\n}\n\nexport function loadPlaylistComplete(playlistID, media, pagination) {\n  return {\n    type: LOAD_PLAYLIST_COMPLETE,\n    payload: { playlistID, media },\n    meta: pagination,\n  };\n}\n\nexport function loadPlaylist(playlistID, page = 0, meta = {}) {\n  return get(`/playlists/${playlistID}/media`, {\n    qs: { page, limit: MEDIA_PAGE_SIZE },\n    onStart: () => loadPlaylistStart(playlistID, page, meta),\n    onComplete: res => loadPlaylistComplete(\n      playlistID,\n      mergeIncludedModels(res).map(flattenPlaylistItem),\n      {\n        page: res.meta.offset / res.meta.pageSize,\n        pageSize: res.meta.pageSize,\n        size: res.meta.total,\n      },\n    ),\n    onError: error => ({\n      type: LOAD_PLAYLIST_COMPLETE,\n      error: true,\n      payload: error,\n      meta: { page },\n    }),\n  });\n}\n\nexport function filterPlaylistItemsStart(playlistID, page, filter) {\n  return {\n    type: FILTER_PLAYLIST_ITEMS_START,\n    payload: { playlistID, filter },\n    meta: { page },\n  };\n}\n\nexport function filterPlaylistItemsComplete(playlistID, media, pagination) {\n  return {\n    type: FILTER_PLAYLIST_ITEMS_COMPLETE,\n    payload: { playlistID, media },\n    meta: pagination,\n  };\n}\n\nexport function loadFilteredPlaylistItems(playlistID, page = 0) {\n  return (dispatch, getState) => {\n    const filter = playlistItemFilterSelector(getState()) || '';\n    return dispatch(get(`/playlists/${playlistID}/media`, {\n      qs: { filter, page, limit: MEDIA_PAGE_SIZE },\n      onStart: () => filterPlaylistItemsStart(playlistID, page, filter),\n      onComplete: res => filterPlaylistItemsComplete(\n        playlistID,\n        mergeIncludedModels(res).map(flattenPlaylistItem),\n        {\n          page: res.meta.offset / res.meta.pageSize,\n          pageSize: res.meta.pageSize,\n          size: res.meta.results,\n          filter,\n        },\n      ),\n      onError: error => ({\n        type: FILTER_PLAYLIST_ITEMS_COMPLETE,\n        error: true,\n        payload: error,\n        meta: { page },\n      }),\n    }));\n  };\n}\n\nexport function filterPlaylistItems(playlistID, filter) {\n  return (dispatch) => {\n    dispatch({\n      type: FILTER_PLAYLIST_ITEMS,\n      payload: { playlistID, filter },\n    });\n\n    const loadAll = loadPlaylist(playlistID, 0);\n    const loadFiltered = loadFilteredPlaylistItems(playlistID, 0);\n    dispatch(filter === '' ? loadAll : loadFiltered);\n  };\n}\n\nexport function selectPlaylist(playlistID) {\n  return (dispatch) => {\n    dispatch({\n      type: SELECT_PLAYLIST,\n      payload: { playlistID },\n    });\n\n    if (playlistID) {\n      dispatch(loadPlaylist(playlistID));\n    }\n  };\n}\n\nexport function playlistCycled(playlistID) {\n  return {\n    type: PLAYLIST_CYCLED,\n    payload: { playlistID },\n  };\n}\n\nfunction shouldLoadAfterCycle(playlist) {\n  const { media } = playlist;\n  // If the playlist was fully loaded, we can cycle naively\n  if (media.length === playlist.size && media.every(Boolean)) {\n    return false;\n  }\n  // If the first page _after_ cycle is fully loaded, we also don't need to do\n  // anything.\n  if (media.length > MEDIA_PAGE_SIZE &&\n      media.slice(1, 1 + MEDIA_PAGE_SIZE).every(Boolean)) {\n    return false;\n  }\n  // Otherwise, there will be unloaded items on the first page after cycling,\n  // so we want to eagerly load the page again.\n  return true;\n}\n\nexport function cyclePlaylist(playlistID) {\n  return (dispatch, getState) => {\n    const activePlaylist = activePlaylistSelector(getState());\n    const selectedPlaylist = selectedPlaylistSelector(getState());\n\n    let playlist;\n\n    if (playlistID === activePlaylist._id) {\n      playlist = activePlaylist;\n    } else if (playlistID === selectedPlaylist._id) {\n      playlist = selectedPlaylist;\n    }\n\n    dispatch(playlistCycled(playlistID));\n\n    if (playlist && shouldLoadAfterCycle(playlist)) {\n      dispatch(loadPlaylist(playlistID, 0));\n    }\n  };\n}\n\nexport function activatePlaylistStart(playlistID) {\n  return {\n    type: ACTIVATE_PLAYLIST_START,\n    payload: { playlistID },\n  };\n}\n\nexport function activatePlaylistComplete(playlistID) {\n  return {\n    type: ACTIVATE_PLAYLIST_COMPLETE,\n    payload: { playlistID },\n  };\n}\n\nexport function activatePlaylist(playlistID) {\n  return put(`/playlists/${playlistID}/activate`, {}, {\n    onStart: () => activatePlaylistStart(playlistID),\n    onComplete: () => activatePlaylistComplete(playlistID),\n    onError: error => ({\n      type: ACTIVATE_PLAYLIST_COMPLETE,\n      error: true,\n      payload: error,\n      meta: { playlistID },\n    }),\n  });\n}\n\nexport function loadPlaylistsStart() {\n  return { type: LOAD_ALL_PLAYLISTS_START };\n}\n\nexport function loadPlaylistsComplete(playlists) {\n  return {\n    type: LOAD_ALL_PLAYLISTS_COMPLETE,\n    payload: { playlists },\n  };\n}\n\nexport function loadPlaylists() {\n  return get('/playlists', {\n    onStart: loadPlaylistsStart,\n    onComplete: res => loadPlaylistsComplete(res.data),\n    onError: error => ({\n      type: LOAD_ALL_PLAYLISTS_COMPLETE,\n      error: true,\n      payload: error,\n    }),\n  });\n}\n\nexport function createPlaylistStart(props, tempId) {\n  return {\n    type: CREATE_PLAYLIST_START,\n    payload: props,\n    meta: { tempId },\n  };\n}\n\nexport function createPlaylistComplete(playlist, tempId) {\n  return {\n    type: CREATE_PLAYLIST_COMPLETE,\n    payload: { playlist },\n    meta: { tempId },\n  };\n}\n\nexport function createPlaylist(name) {\n  const tempId = -Date.now();\n  const description = '';\n  const shared = false;\n\n  return post('/playlists', { name, description, shared }, {\n    onStart: () => createPlaylistStart({ name, description, shared }, tempId),\n    onComplete: res => (dispatch, getState) => {\n      const playlist = res.data;\n      const isFirstPlaylist = !activePlaylistIDSelector(getState());\n      dispatch(createPlaylistComplete(playlist, tempId));\n      if (isFirstPlaylist) {\n        dispatch(activatePlaylistComplete(playlist._id));\n      }\n      return playlist;\n    },\n    onError: error => ({\n      type: CREATE_PLAYLIST_COMPLETE,\n      error: true,\n      payload: error,\n      meta: { tempId },\n    }),\n  });\n}\n\nexport function renamePlaylist(playlistID, name) {\n  return put(`/playlists/${playlistID}/rename`, { name }, {\n    onStart: () => ({\n      type: RENAME_PLAYLIST_START,\n      payload: { playlistID, name },\n    }),\n    onComplete: ({ data }) => ({\n      type: RENAME_PLAYLIST_COMPLETE,\n      payload: { playlistID, name: data.name },\n    }),\n    onError: error => ({\n      type: RENAME_PLAYLIST_COMPLETE,\n      error: true,\n      payload: error,\n      meta: { playlistID, name },\n    }),\n  });\n}\n\n/**\n * Select or activate a different playlist than the one given.\n * @return Promise\n */\n\nexport function deselectPlaylist(playlistID) {\n  return (dispatch, getState) => {\n    const selectedID = selectedPlaylistIDSelector(getState());\n    const activeID = activePlaylistIDSelector(getState());\n    if (playlistID === selectedID) {\n      dispatch(selectPlaylist(activeID));\n    }\n  };\n}\n\nexport function deletePlaylistStart(playlistID) {\n  return {\n    type: DELETE_PLAYLIST_START,\n    payload: { playlistID },\n  };\n}\n\nexport function deletePlaylistComplete(playlistID) {\n  return {\n    type: DELETE_PLAYLIST_COMPLETE,\n    payload: { playlistID },\n  };\n}\n\nexport function cannotDeleteActivePlaylist(playlistID) {\n  return {\n    type: DELETE_PLAYLIST_COMPLETE,\n    error: true,\n    payload: new Error('The active playlist cannot be deleted. ' +\n      'Activate a different playlist first, before deleting this one.'),\n    meta: { playlistID },\n  };\n}\n\nexport function deletePlaylist(playlistID) {\n  return (dispatch, getState) => {\n    const activeID = activePlaylistIDSelector(getState());\n\n    if (playlistID === activeID) {\n      dispatch(cannotDeleteActivePlaylist(playlistID));\n      return null;\n    }\n\n    dispatch(deselectPlaylist(playlistID));\n\n    return dispatch(del(`/playlists/${playlistID}`, {}, {\n      onStart: () => deletePlaylistStart(playlistID),\n      onComplete: () => deletePlaylistComplete(playlistID),\n      onError: error => ({\n        type: DELETE_PLAYLIST_COMPLETE,\n        error: true,\n        payload: error,\n        meta: { playlistID },\n      }),\n    }));\n  };\n}\n\nexport function addMediaMenu(items, position) {\n  return (dispatch, getState) => {\n    const playlists = playlistsSelector(getState());\n    dispatch({\n      type: OPEN_ADD_MEDIA_MENU,\n      payload: {\n        media: items,\n      },\n      meta: {\n        playlists,\n        position,\n        type: 'add',\n      },\n    });\n  };\n}\n\nexport function closeAddMediaMenu() {\n  return { type: CLOSE_ADD_MEDIA_MENU };\n}\n\nexport function addMediaStart(playlistID, media, location) {\n  return {\n    type: ADD_MEDIA_START,\n    payload: { playlistID, media, location },\n  };\n}\n\nexport function addMediaComplete(playlistID, newSize, insert) {\n  return {\n    type: ADD_MEDIA_COMPLETE,\n    payload: {\n      playlistID,\n      newSize,\n      afterID: insert.afterID,\n      appendedMedia: insert.media,\n    },\n  };\n}\n\n/**\n * Keep only the playlist item properties that are necessary to add an item to\n * a playlist. The rest (\"thumbnail\" etc) is left out for smaller payloads.\n */\n\nfunction minimizePlaylistItem(item) {\n  return {\n    sourceType: item.sourceType,\n    sourceID: item.sourceID,\n    artist: item.artist,\n    title: item.title,\n    start: item.start,\n    end: item.end,\n  };\n}\n\nexport function addMedia(playlist, items, afterID = null) {\n  const payload = {\n    items: items.map(minimizePlaylistItem),\n    after: afterID,\n  };\n\n  return post(`/playlists/${playlist._id}/media`, payload, {\n    onStart: () => addMediaStart(playlist._id, items, afterID),\n    onComplete: res => addMediaComplete(\n      playlist._id,\n      res.meta.playlistSize,\n      { afterID, media: mergeIncludedModels(res).map(flattenPlaylistItem) },\n    ),\n    onError: error => ({\n      type: ADD_MEDIA_COMPLETE,\n      error: true,\n      payload: error,\n    }),\n  });\n}\n\nexport function editMedia(playlistID, media) {\n  return openEditMediaDialog(playlistID, media);\n}\n\nexport function updateMediaStart(playlistID, mediaID, props) {\n  return {\n    type: UPDATE_MEDIA_START,\n    payload: { playlistID, mediaID, props },\n  };\n}\n\nexport function updateMediaComplete(playlistID, mediaID, media) {\n  return {\n    type: UPDATE_MEDIA_COMPLETE,\n    payload: { playlistID, mediaID, media },\n  };\n}\n\nexport function updateMedia(playlistID, mediaID, props) {\n  return put(`/playlists/${playlistID}/media/${mediaID}`, props, {\n    onStart: () => updateMediaStart(playlistID, mediaID, props),\n    onComplete: res => updateMediaComplete(playlistID, mediaID, res.data),\n    onError: error => ({\n      type: UPDATE_MEDIA_COMPLETE,\n      payload: error,\n      error: true,\n      meta: { playlistID, mediaID, props },\n    }),\n  });\n}\n\nexport function removeMediaStart(playlistID, items) {\n  return {\n    type: REMOVE_MEDIA_START,\n    payload: { playlistID, medias: items },\n  };\n}\n\nexport function removeMediaComplete(playlistID, newSize, removedMedia) {\n  return {\n    type: REMOVE_MEDIA_COMPLETE,\n    payload: {\n      playlistID,\n      newSize,\n      removedMedia,\n    },\n  };\n}\n\nexport function removeMedia(playlistID, items) {\n  const itemIDs = items.map(media => media._id);\n  return del(`/playlists/${playlistID}/media`, { items: itemIDs }, {\n    onStart: () => removeMediaStart(playlistID, items),\n    onComplete: ({ meta }) => removeMediaComplete(\n      playlistID,\n      meta.playlistSize,\n      items,\n    ),\n    onError: error => ({\n      type: REMOVE_MEDIA_COMPLETE,\n      error: true,\n      payload: error,\n    }),\n  });\n}\n\nexport function moveMediaStart(playlistID, items, location) {\n  return {\n    type: MOVE_MEDIA_START,\n    payload: { playlistID, location, medias: items },\n  };\n}\n\nexport function moveMediaComplete(playlistID, items, location) {\n  return {\n    type: MOVE_MEDIA_COMPLETE,\n    payload: { playlistID, location, medias: items },\n  };\n}\n\nfunction resolveMoveOptions(playlist = [], opts = {}) {\n  if (opts.after) {\n    return { after: opts.after };\n  }\n  if (opts.before) {\n    for (let i = 0, l = playlist.length; i < l; i += 1) {\n      if (playlist[i] && playlist[i]._id === opts.before) {\n        if (i === 0) {\n          return { at: 'start' };\n        }\n        return { after: playlist[i - 1]._id };\n      }\n    }\n  }\n  if (opts.at) {\n    return { at: opts.at };\n  }\n  return null;\n}\n\nexport function moveMedia(playlistID, medias, opts) {\n  return (dispatch, getState) => {\n    const playlistItems = playlistItemsSelector(getState())[playlistID];\n    const location = resolveMoveOptions(playlistItems, opts);\n\n    const items = medias.map(media => media._id);\n\n    return dispatch(put(`/playlists/${playlistID}/move`, { items, ...location }, {\n      onStart: () => moveMediaStart(playlistID, medias, location),\n      onComplete: () => moveMediaComplete(playlistID, medias, location),\n      onError: error => ({\n        type: MOVE_MEDIA_COMPLETE,\n        error: true,\n        payload: error,\n        meta: { playlistID, medias, location },\n      }),\n    }));\n  };\n}\n\nexport function shufflePlaylistStart(playlistID) {\n  return {\n    type: SHUFFLE_PLAYLIST_START,\n    payload: { playlistID },\n  };\n}\n\nexport function shufflePlaylistComplete(playlistID) {\n  return (dispatch) => {\n    dispatch({\n      type: SHUFFLE_PLAYLIST_COMPLETE,\n      payload: { playlistID },\n    });\n  };\n}\n\nexport function shufflePlaylist(playlistID) {\n  return (dispatch) => {\n    const shuffleOperation = post(`/playlists/${playlistID}/shuffle`, {}, {\n      onStart: () => shufflePlaylistStart(playlistID),\n      // onComplete: () => shufflePlaylistComplete(playlistID),\n      onError: error => ({\n        type: SHUFFLE_PLAYLIST_COMPLETE,\n        error: true,\n        payload: error,\n        meta: { playlistID },\n      }),\n    });\n    const loadOperation = loadPlaylist(playlistID, 0, { sneaky: true });\n\n    return dispatch(shuffleOperation)\n      .then(() => dispatch(loadOperation))\n      .then(() => dispatch(shufflePlaylistComplete(playlistID)));\n  };\n}\n"]}