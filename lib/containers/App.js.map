{"version":3,"sources":["containers/App.js"],"names":["SimpleProviders","mapStateToProps","activeOverlay","state","isConnected","settings","language","theme","hasAboutPage","props","uwave","getAboutPageComponent","mapDispatchToProps","onCloseOverlay","enhance","AppContainer","_React$Component","_temp","_this","_ret","_len","arguments","length","args","Array","_key","call","apply","concat","error","renderApp","Fragment","createElement","prototype","getChildContext","mediaSources","componentWillReceiveProps","nextProps","locale","changeLanguage","componentDidCatch","info","setState","bugsnag","notify","metaData","componentStack","render","i18n","Component","childContextTypes","object","propTypes","process","env","NODE_ENV","isRequired","string"],"mappings":"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","file":"App.js","sourcesContent":["/* global bugsnag */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport nest from 'recompose/nest';\nimport { connect } from 'react-redux';\nimport { createStructuredSelector } from 'reselect';\nimport { MuiThemeProvider } from 'material-ui/styles';\nimport { I18nextProvider } from 'react-i18next';\nimport { Provider as BusProvider } from 'react-bus';\nimport { Mobile, Desktop } from '../components/Responsive';\nimport ClockProvider from '../components/ClockProvider';\nimport { closeAll } from '../actions/OverlayActionCreators';\nimport {\n  settingsSelector,\n  languageSelector,\n  themeSelector,\n} from '../selectors/settingSelectors';\nimport { isConnectedSelector } from '../selectors/serverSelectors';\nimport DesktopApp from '../components/App';\nimport MobileApp from '../mobile/components/App';\nimport FatalError from '../components/FatalError';\n\nconst SimpleProviders = nest(BusProvider, ClockProvider);\n\nconst mapStateToProps = createStructuredSelector({\n  activeOverlay: state => state.activeOverlay,\n  isConnected: isConnectedSelector,\n  settings: settingsSelector,\n  language: languageSelector,\n  theme: themeSelector,\n  hasAboutPage: (state, props) => (\n    props.uwave.getAboutPageComponent() !== null\n  ),\n});\n\nconst mapDispatchToProps = {\n  onCloseOverlay: closeAll,\n};\n\nconst enhance = connect(mapStateToProps, mapDispatchToProps);\n\nclass AppContainer extends React.Component {\n  static propTypes = {\n    mediaSources: PropTypes.object.isRequired,\n    uwave: PropTypes.object,\n    language: PropTypes.string,\n    theme: PropTypes.object,\n    locale: PropTypes.object.isRequired,\n  };\n\n  static childContextTypes = {\n    mediaSources: PropTypes.object,\n    uwave: PropTypes.object,\n  };\n\n  state = {\n    error: null,\n  };\n\n  getChildContext() {\n    return {\n      mediaSources: this.props.mediaSources,\n      uwave: this.props.uwave,\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.language !== nextProps.language) {\n      this.props.locale.changeLanguage(nextProps.language);\n    }\n  }\n\n  componentDidCatch(error, info) {\n    this.setState({ error });\n\n    bugsnag.notify(error, {\n      metaData: {\n        componentStack: info.componentStack,\n      },\n    });\n  }\n\n  renderApp = () => (\n    <React.Fragment>\n      <Mobile>\n        <MobileApp {...this.props} />\n      </Mobile>\n      <Desktop>\n        <DesktopApp {...this.props} />\n      </Desktop>\n    </React.Fragment>\n  );\n\n  render() {\n    if (this.state.error) {\n      // Let's hope the ThemeProvider works at least...\n      return (\n        <MuiThemeProvider theme={this.props.theme}>\n          <FatalError error={this.state.error} />\n        </MuiThemeProvider>\n      );\n    }\n\n    return (\n      <MuiThemeProvider theme={this.props.theme}>\n        <I18nextProvider i18n={this.props.locale}>\n          <SimpleProviders>\n            {this.renderApp()}\n          </SimpleProviders>\n        </I18nextProvider>\n      </MuiThemeProvider>\n    );\n  }\n}\n\nexport default enhance(AppContainer);\n"]}