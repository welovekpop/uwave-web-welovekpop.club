{"version":3,"sources":["mobile/components/Video/index.js"],"names":["Video","_React$Component","_temp","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","sourceType","undefined","enableOverlay","showVoteButtons","handleClick","setState","s","handlePlay","getDerivedStateFromProps","nextProps","prevState","_ref","media","_proto","prototype","render","_this$props","props","voteStats","onUpvote","onDownvote","onFavorite","_this$state","className","VideoBackdrop","url","thumbnail","React","createElement","Player","size","onPlay","onClick","VoteButtons","Component","propTypes","process","env","NODE_ENV","PropTypes","shape","string","isRequired","isUpvote","bool","isFavorite","isDownvote","func"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA,IAAIA;AACJ;AACA,UAAUC,gBAAV,EAA4B;AAC1B,+BAAeD,KAAf,EAAsBC,gBAAtB;;AAEA,WAASD,KAAT,GAAiB;AACf,QAAIE,KAAJ,EAAWC,KAAX;;AAEA,SAAK,IAAIC,OAAOC,UAAUC,MAArB,EAA6BC,OAAO,IAAIC,KAAJ,CAAUJ,IAAV,CAApC,EAAqDK,OAAO,CAAjE,EAAoEA,OAAOL,IAA3E,EAAiFK,MAAjF,EAAyF;AACvFF,WAAKE,IAAL,IAAaJ,UAAUI,IAAV,CAAb;AACD;;AAED,WAAO,CAACP,QAAQC,QAAQF,iBAAiBS,IAAjB,CAAsBC,KAAtB,CAA4BV,gBAA5B,EAA8C,CAAC,IAAD,EAAOW,MAAP,CAAcL,IAAd,CAA9C,KAAsE,IAAtF,EAA4FJ,MAAMU,KAAN,GAAc;AAChHC,kBAAYC,SADoG;AAEhH;AACAC,qBAAe,KAHiG;AAIhHC,uBAAiB;AAJ+F,KAA1G,EAKLd,MAAMe,WAAN,GAAoB,YAAY;AACjCf,YAAMgB,QAAN,CAAe,UAAUC,CAAV,EAAa;AAC1B,eAAO;AACLH,2BAAiB,CAACG,EAAEH;AADf,SAAP;AAGD,OAJD;AAKD,KAXO,EAWLd,MAAMkB,UAAN,GAAmB,YAAY;AAChClB,YAAMgB,QAAN,CAAe;AACbH,uBAAe;AADF,OAAf;AAGD,KAfO,EAeLd,KAfI,KAeM,qCAAuBC,KAAvB,CAfb;AAgBD;;AAEDH,QAAMsB,wBAAN,GAAiC,SAASA,wBAAT,CAAkCC,SAAlC,EAA6CC,SAA7C,EAAwD;AACvF,QAAIC,OAAOF,UAAUG,KAAV,IAAmB,EAA9B;AAAA,QACIZ,aAAaW,KAAKX,UADtB,CADuF,CAErD;AAClC;;;AAGA,QAAIA,eAAeU,UAAUV,UAA7B,EAAyC;AACvC,aAAO;AACLE,uBAAeF,eAAeC,SADzB;AAELD,oBAAYA;AAFP,OAAP;AAID;;AAED,WAAO,IAAP;AACD,GAdD;;AAgBA,MAAIa,SAAS3B,MAAM4B,SAAnB;;AAEAD,SAAOE,MAAP,GAAgB,SAASA,MAAT,GAAkB;AAChC,QAAIC,cAAc,KAAKC,KAAvB;AAAA,QACIL,QAAQI,YAAYJ,KADxB;AAAA,QAEIM,YAAYF,YAAYE,SAF5B;AAAA,QAGIC,WAAWH,YAAYG,QAH3B;AAAA,QAIIC,aAAaJ,YAAYI,UAJ7B;AAAA,QAKIC,aAAaL,YAAYK,UAL7B;AAAA,QAMIJ,QAAQ,uCAAyBD,WAAzB,EAAsC,CAAC,OAAD,EAAU,WAAV,EAAuB,UAAvB,EAAmC,YAAnC,EAAiD,YAAjD,CAAtC,CANZ;AAQA,QAAIM,cAAc,KAAKvB,KAAvB;AAAA,QACIG,gBAAgBoB,YAAYpB,aADhC;AAAA,QAEIC,kBAAkBmB,YAAYnB,eAFlC;AAGA,WAAO,mBAAK,KAAL,EAAY;AACjBoB,iBAAW;AADM,KAAZ,EAEJ,KAAK,CAFD,EAEIX,SAAS,mBAAKY,sBAAL,EAAoB;AACtCC,WAAKb,MAAMc;AAD2B,KAApB,CAFb,EAIH,mBAAK,KAAL,EAAY;AACdH,iBAAW;AADG,KAAZ,EAED,KAAK,CAFJ,EAEOI,eAAMC,aAAN,CAAoBC,eAApB,EAA4B,uBAAS,EAAT,EAAaZ,KAAb,EAAoB;AACzDL,aAAOA,KADkD;AAEzDkB,YAAM,OAFmD;AAGzDC,cAAQ,KAAKxB;AAH4C,KAApB,CAA5B,CAFP,CAJG,EAUDL,iBAAiB,mBAAK,QAAL,EAAe;AACpCqB,iBAAW,qBADyB;AAEpCS,eAAS,KAAK5B,WAFsB;AAGpC,oBAAc;AAHsB,KAAf,CAVhB,EAcHD,mBAAmB,mBAAK,KAAL,EAAY;AACjCoB,iBAAW;AADsB,KAAZ,EAEpB,KAAK,CAFe,EAEZI,eAAMC,aAAN,CAAoBK,oBAApB,EAAiC,uBAAS,EAAT,EAAaf,SAAb,EAAwB;AAClEC,gBAAUA,QADwD;AAElEC,kBAAYA,UAFsD;AAGlEC,kBAAYA;AAHsD,KAAxB,CAAjC,CAFY,CAdhB,CAAP;AAqBD,GAjCD;;AAmCA,SAAOnC,KAAP;AACD,CAlFD,CAkFEyC,eAAMO,SAlFR,CAFA;;AAsFAhD,MAAMiD,SAAN,GAAkBC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC;AACxD1B,SAAO2B,mBAAUC,KAAV,CAAgB;AACrBxC,gBAAYuC,mBAAUE,MAAV,CAAiBC,UADR;AAErBhB,eAAWa,mBAAUE,MAAV,CAAiBC;AAFP,GAAhB,CADiD;AAKxDxB,aAAWqB,mBAAUC,KAAV,CAAgB;AACzBG,cAAUJ,mBAAUK,IADK;AAEzBC,gBAAYN,mBAAUK,IAFG;AAGzBE,gBAAYP,mBAAUK;AAHG,GAAhB,CAL6C;AAUxDzB,YAAUoB,mBAAUQ,IAAV,CAAeL,UAV+B;AAWxDtB,cAAYmB,mBAAUQ,IAAV,CAAeL,UAX6B;AAYxDrB,cAAYkB,mBAAUQ,IAAV,CAAeL;AAZ6B,CAAxC,GAad,EAbJ;eAcexD,K","file":"index.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport Player from '../../../components/Player';\nimport VideoBackdrop from '../../../components/Video/VideoBackdrop';\nimport VoteButtons from './VoteButtons';\n\nclass Video extends React.Component {\n  static propTypes = {\n    media: PropTypes.shape({\n      sourceType: PropTypes.string.isRequired,\n      thumbnail: PropTypes.string.isRequired,\n    }),\n    voteStats: PropTypes.shape({\n      isUpvote: PropTypes.bool,\n      isFavorite: PropTypes.bool,\n      isDownvote: PropTypes.bool,\n    }),\n\n    onUpvote: PropTypes.func.isRequired,\n    onDownvote: PropTypes.func.isRequired,\n    onFavorite: PropTypes.func.isRequired,\n  };\n\n  state = {\n    sourceType: undefined, // eslint-disable-line react/no-unused-state\n    enableOverlay: false,\n    showVoteButtons: false,\n  };\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    const { sourceType } = nextProps.media || {};\n    // Switching to a different source type may require an autoplay tap again.\n    // Disable the vote buttons until the media source reports playback started.\n    if (sourceType !== prevState.sourceType) {\n      return {\n        enableOverlay: sourceType === undefined,\n        sourceType,\n      };\n    }\n    return null;\n  }\n\n  handleClick = () => {\n    this.setState(s => ({\n      showVoteButtons: !s.showVoteButtons,\n    }));\n  };\n\n  // Add the vote buttons tap-trap once autoplay permission is granted.\n  handlePlay = () => {\n    this.setState({ enableOverlay: true });\n  };\n\n  render() {\n    const {\n      media,\n      voteStats,\n      onUpvote,\n      onDownvote,\n      onFavorite,\n      ...props\n    } = this.props;\n    const { enableOverlay, showVoteButtons } = this.state;\n\n    return (\n      <div className=\"Video\">\n        {media && <VideoBackdrop url={media.thumbnail} />}\n        <div className=\"Video-player\">\n          <Player\n            {...props}\n            media={media}\n            size=\"large\"\n            onPlay={this.handlePlay}\n          />\n        </div>\n        {enableOverlay && (\n          <button\n            className=\"Video-buttonTrigger\"\n            onClick={this.handleClick}\n            aria-label=\"Show vote buttons\"\n          />\n        )}\n        {showVoteButtons && (\n          <div className=\"Video-buttons\">\n            <VoteButtons\n              {...voteStats}\n              onUpvote={onUpvote}\n              onDownvote={onDownvote}\n              onFavorite={onFavorite}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Video;\n"]}