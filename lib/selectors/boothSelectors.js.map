{"version":3,"sources":["selectors/boothSelectors.js"],"names":["baseSelector","state","booth","historyIDSelector","historyID","mediaSelector","media","startTimeSelector","startTime","mediaDurationSelector","end","start","endTimeSelector","duration","timeElapsedSelector","currentTime","Math","max","timeRemainingSelector","elapsed","mediaProgressSelector","min","djSelector","users","djID","isCurrentDJSelector","dj","me","_id","canSkipSelector","isCurrentDJ","hasRole","playbackVolumeSelector","volume","isMuted","isPreviewMediaDialogOpen"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;;AACA;;AACA;;AAEA,IAAIA,eAAe,SAASA,YAAT,CAAsBC,KAAtB,EAA6B;AAC9C,SAAOA,MAAMC,KAAb;AACD,CAFD;;AAIO,IAAIC,gDAAoB,8BAAeH,YAAf,EAA6B,UAAUE,KAAV,EAAiB;AAC3E,SAAOA,MAAME,SAAb;AACD,CAF8B,CAAxB;AAGA,IAAIC,wCAAgB,8BAAeL,YAAf,EAA6B,UAAUE,KAAV,EAAiB;AACvE,SAAOA,MAAMI,KAAb;AACD,CAF0B,CAApB;AAGA,IAAIC,gDAAoB,8BAAeP,YAAf,EAA6B,UAAUE,KAAV,EAAiB;AAC3E,SAAOA,MAAMM,SAAN,IAAmB,CAA1B;AACD,CAF8B,CAAxB;;AAIA,IAAIC,wDAAwB,8BAAeJ,aAAf,EAA8B,UAAUC,KAAV,EAAiB;AAChF,SAAOA,QAAQA,MAAMI,GAAN,GAAYJ,MAAMK,KAA1B,GAAkC,CAAzC;AACD,CAFkC,CAA5B;;AAIA,IAAIC,4CAAkB,8BAAeL,iBAAf,EAAkCE,qBAAlC,EAAyD,UAAUD,SAAV,EAAqBK,QAArB,EAA+B;AACnH,SAAOL,YAAYK,WAAW,IAAvB,IAA+B,CAAtC;AACD,CAF4B,CAAtB;;AAIA,IAAIC,oDAAsB,8BAAeP,iBAAf;AACjC;AACA,UAAUC,SAAV,EAAqBO,WAArB,EAAkC;AAChC,SAAOP,YAAYQ,KAAKC,GAAL,CAAS,CAACF,cAAcP,SAAf,IAA4B,IAArC,EAA2C,CAA3C,CAAZ,GAA4D,CAAnE;AACD,CAJgC,CAA1B;;AAMA,IAAIU,wDAAwB,8BAAeT,qBAAf,EAAsCK,mBAAtC,EAA2D,UAAUD,QAAV,EAAoBM,OAApB,EAA6B;AACzH,SAAON,WAAW,CAAX,GAAeA,WAAWM,OAA1B,GAAoC,CAA3C;AACD,CAFkC,CAA5B;;AAIA,IAAIC,wDAAwB,8BAAeX,qBAAf,EAAsCK,mBAAtC,EAA2D,UAAUD,QAAV,EAAoBM,OAApB,EAA6B;AACzH,SAAON;AACP;AADO,IAELG,KAAKC,GAAL,CAAS,CAAT,EAAYD,KAAKK,GAAL,CAAS,CAAT,EAAYF,UAAUN,QAAtB,CAAZ,CAFK,GAE0C,CAFjD;AAGD,CAJkC,CAA5B;;AAMA,IAAIS,kCAAa,8BAAetB,YAAf,gCAA4C,UAAUE,KAAV,EAAiBqB,KAAjB,EAAwB;AAC1F,SAAOA,MAAMrB,MAAMsB,IAAZ,CAAP;AACD,CAFuB,CAAjB;;AAIA,IAAIC,oDAAsB,8BAAeH,UAAf,sCAAgD,UAAUI,EAAV,EAAcC,EAAd,EAAkB;AACjG,SAAOD,MAAMC,EAAN,GAAWD,GAAGE,GAAH,KAAWD,GAAGC,GAAzB,GAA+B,KAAtC;AACD,CAFgC,CAA1B;;AAIA,IAAIC,4CAAkB,8BAAe1B,iBAAf,EAAkCsB,mBAAlC,6CAAmF,UAAUrB,SAAV,EAAqB0B,WAArB,EAAkCC,OAAlC,EAA2C;AACzJ,MAAI,CAAC3B,SAAL,EAAgB;AACd,WAAO,KAAP;AACD;AACD,SAAO0B,cAAcC,QAAQ,iBAAR,CAAd,GAA2CA,QAAQ,kBAAR,CAAlD;AACD,CAL4B,CAAtB;;AAOA,IAAIC,0DAAyB,sJAAkF,UAAUC,MAAV,EAAkBC,OAAlB,EAA2BC,wBAA3B,EAAqD;AACzK,SAAOD,WAAWC,wBAAX,GAAsC,CAAtC,GAA0CF,MAAjD;AACD,CAFmC,CAA7B;AAGP","file":"boothSelectors.js","sourcesContent":["import { createSelector } from 'reselect';\n\nimport { isPreviewMediaDialogOpenSelector } from './dialogSelectors';\nimport { isMutedSelector, volumeSelector } from './settingSelectors';\nimport { currentTimeSelector } from './timeSelectors';\nimport {\n  currentUserSelector,\n  currentUserHasRoleSelector,\n  usersSelector,\n} from './userSelectors';\n\nconst baseSelector = state => state.booth;\n\nexport const historyIDSelector = createSelector(baseSelector, booth => booth.historyID);\nexport const mediaSelector = createSelector(baseSelector, booth => booth.media);\nexport const startTimeSelector = createSelector(baseSelector, booth => booth.startTime || 0);\n\nexport const mediaDurationSelector = createSelector(\n  mediaSelector,\n  media => (media ? media.end - media.start : 0),\n);\n\nexport const endTimeSelector = createSelector(\n  startTimeSelector,\n  mediaDurationSelector,\n  (startTime, duration) => startTime + (duration * 1000) || 0,\n);\n\nexport const timeElapsedSelector = createSelector(\n  startTimeSelector,\n  currentTimeSelector,\n  // in seconds! because media duration is in seconds, too.\n  (startTime, currentTime) => (startTime ? Math.max((currentTime - startTime) / 1000, 0) : 0),\n);\n\nexport const timeRemainingSelector = createSelector(\n  mediaDurationSelector,\n  timeElapsedSelector,\n  (duration, elapsed) => (duration > 0 ? duration - elapsed : 0),\n);\n\nexport const mediaProgressSelector = createSelector(\n  mediaDurationSelector,\n  timeElapsedSelector,\n  (duration, elapsed) => (\n    duration\n      // Ensure that the result is between 0 and 1\n      ? Math.max(0, Math.min(1, elapsed / duration))\n      : 0\n  ),\n);\n\nexport const djSelector = createSelector(\n  baseSelector,\n  usersSelector,\n  (booth, users) => users[booth.djID],\n);\n\nexport const isCurrentDJSelector = createSelector(\n  djSelector,\n  currentUserSelector,\n  (dj, me) => (\n    dj && me ? dj._id === me._id : false\n  ),\n);\n\nexport const canSkipSelector = createSelector(\n  historyIDSelector,\n  isCurrentDJSelector,\n  currentUserHasRoleSelector,\n  (historyID, isCurrentDJ, hasRole) => {\n    if (!historyID) {\n      return false;\n    }\n    return isCurrentDJ ? hasRole('booth.skip.self') : hasRole('booth.skip.other');\n  },\n);\n\nexport const playbackVolumeSelector = createSelector(\n  volumeSelector,\n  isMutedSelector,\n  isPreviewMediaDialogOpenSelector,\n  (volume, isMuted, isPreviewMediaDialogOpen) =>\n    (isMuted || isPreviewMediaDialogOpen ? 0 : volume),\n);\n"]}