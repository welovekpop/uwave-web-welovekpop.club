{"version":3,"sources":["utils/commands/waitlist.js"],"names":["guard","isModeratorSelector","action","_len","arguments","length","args","Array","_key","join","username","dispatch","getState","user","modClearWaitlist","modLockWaitlist","modUnlockWaitlist","posStr","position","parseInt"],"mappings":"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","file":"waitlist.js","sourcesContent":["import { register, findUser } from '../ChatCommands';\nimport { log } from '../../actions/ChatActionCreators';\n\nimport {\n  joinWaitlist,\n  modClearWaitlist,\n  modLockWaitlist,\n  modUnlockWaitlist,\n} from '../../actions/WaitlistActionCreators';\nimport {\n  skipCurrentDJ,\n  removeWaitlistUser,\n  moveWaitlistUser,\n} from '../../actions/ModerationActionCreators';\nimport {\n  userListSelector,\n  isModeratorSelector,\n} from '../../selectors/userSelectors';\nimport {\n  waitlistUsersSelector,\n  djAndWaitlistUsersSelector,\n} from '../../selectors/waitlistSelectors';\n\nregister('skip', 'Skip the current DJ.', {\n  guard: isModeratorSelector,\n  action: (...args) => skipCurrentDJ(args ? args.join(' ') : '[No reason given]'),\n});\n\nregister(\n  'wladd',\n  'Add a user to the waitlist. Syntax: \"/wladd username\"',\n  {\n    guard: isModeratorSelector,\n    action: username => (dispatch, getState) => {\n      if (!username) {\n        return dispatch(log('Provide a user to add to the waitlist. Syntax: \"/wladd username\"'));\n      }\n\n      const user = findUser(userListSelector(getState()), username);\n      if (user) {\n        return dispatch(joinWaitlist(user));\n      }\n      return dispatch(log(`User ${username} is not online right now.`));\n    },\n  },\n);\n\nregister(\n  'wlremove',\n  'Remove a user from the waitlist. Syntax: \"/wlremove username\"',\n  {\n    guard: isModeratorSelector,\n    action: username => (dispatch, getState) => {\n      if (!username) {\n        return dispatch(log('Provide a user to remove from the waitlist. Syntax: \"/wlremove username\"'));\n      }\n\n      const user = findUser(\n        djAndWaitlistUsersSelector(getState()),\n        username,\n      );\n      if (user) {\n        return dispatch(removeWaitlistUser(user));\n      }\n      return dispatch(log(`User ${username} is not in the waitlist.`));\n    },\n  },\n);\n\nregister(\n  'wlclear',\n  'Remove everyone from the waitlist.',\n  { guard: isModeratorSelector, action: modClearWaitlist },\n);\n\nregister(\n  'wllock',\n  'Lock the waitlist.',\n  { guard: isModeratorSelector, action: modLockWaitlist },\n);\n\nregister(\n  'wlunlock',\n  'Unlock the waitlist.',\n  { guard: isModeratorSelector, action: modUnlockWaitlist },\n);\n\nregister(\n  'wlmove',\n  'Move a user to a different position in the waitlist. ' +\n  'Syntax: \"/wlmove username position\"',\n  {\n    guard: isModeratorSelector,\n    action: (username, posStr) => (dispatch, getState) => {\n      if (!username) {\n        return dispatch(log('Provide a user to move in the waitlist. Syntax: \"/wlmove username position\"'));\n      }\n      const position = parseInt(posStr, 10) - 1;\n      if (typeof position !== 'number' || position < 0) {\n        return dispatch(log(`Provide a position to move @${username} to. Syntax: \"/wlmove username position\"`));\n      }\n\n      const user = findUser(\n        waitlistUsersSelector(getState()),\n        username,\n      );\n      if (user) {\n        return dispatch(moveWaitlistUser(user, position));\n      }\n      return dispatch(log(`User ${username} is not in the waitlist.`));\n    },\n  },\n);\n"]}